Week-7

1. Немного по другому запек NavMesh. Создал иерархию объектов в Unity с названием Map, на нее повесил NavMeshSurface. Внутри этой иерархии на объекты стен повесил NavMeshModifier, который при запекании через NavMeshSurface вычитает эти объекты из поверхности.

2. Добавил реализацию машины состояний с дженериками, можно посмотреть тут https://github.com/NikolaiKochergin/EGMulty_ClashRoyal_Client/tree/week-7/Assets/Source/Scripts/GameCore/UnitLogic/States. У State все же назвал методы Enter Exit и Update, мне так привычнее.

3. На будущее для контролирования порядка инициализации игры добавил Bootstrap. Для него установил Script Execution Order -500, сразу после EventSystem. Это будет единственный скрипт, для которого мы задаем Script Execution Order.

4. Добавил скрипт Team, который собирает башни и юниты игрока и противника соответственно. Метод GetNearestTowerPosition перенес из MapInfo в Team, убрал проверку isEnemy. Добавил 2 сервиса PlayerService и EnemyService, которые хранят свои команды. Эти сервисы так же инициалзируют своих юнитов и выдают им команды протвника. Инициализация сервисов происходит в Bootstrap. Инициализация этих сервисов сейчас довольно костыльная )). Но это временно, думаю хогда будет понятно как будут спавниться юниты игрока и противнка она приобретет более нормальный вид.

В таком варианте это некоторый задел на будущую архитектуру. В дальнейшем скорее всего переработаю методы Construct и Initialize, то что они делают, когда будет понятна структура проекта. Так же в будущем планирую добавить DI.

5. Добавил интерфейс ITarget. Хранит в себе трансформ цели и радиус цели, так же добавил в него реализацию по умолчанию метода GetDistance, которая в лекцих была у Tower.

6. Немного подумал и пока что убрал GetDistance из ITarget, тк не получалось отладить переключения состояний.

7. Добавил уничтожение башен и юнитов при смерти. Добавил состояние смерти для юнитов. В AttackState в Update переделал проверку на смерть атакуемого юнита. Тк в моей реализации _target все еще мог существовать в текущем кадре, хотя его объект уже был уничтожен (По крайне мере я это так понял).

8. Добавил юнитам состояние победы, если все башни и вражеские юниты уже уничтожены.

9. Добавил юнитам и башням по слайдеру, для отображения здоровья.


